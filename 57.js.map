{"version":3,"file":"57.js","sources":["webpack://shark/./src/components/video-player/index.tsx","webpack://shark/./src/pages/video/index.tsx"],"sourcesContent":["import { message } from 'antd'\nimport type { ForwardedRef, MutableRefObject } from 'react'\nimport React, { forwardRef, useEffect, useRef, useState } from 'react'\nimport { t } from '@/utils'\n\ninterface VideoPlayerProps {\n  src: string\n  width?: string\n  height?: string\n}\n\nconst VideoPlayer = forwardRef(\n  (props: VideoPlayerProps, ref: ForwardedRef<HTMLVideoElement>) => {\n    const { src, width = '100%', height = '90%' } = props\n    const videoRef = useRef<HTMLVideoElement>(null)\n    const [isPlaying, setIsPlaying] = useState(false)\n    const [volume, setVolume] = useState(1)\n    const [progress, setProgress] = useState(0)\n    const [isDragging, setIsDragging] = useState(false)\n    const [currentTime, setCurrentTime] = useState('00:00')\n    const [duration, setDuration] = useState('00:00')\n    const [isPictureInPicture, setIsPictureInPicture] = useState(false)\n\n    const formatTime = (time: number): string => {\n      const minutes = Math.floor(time / 60)\n      const seconds = Math.floor(time % 60)\n      const minutesStr = String(minutes).padStart(2, '0')\n      const secondsStr = String(seconds).padStart(2, '0')\n      return `${minutesStr}:${secondsStr}`\n    }\n    useEffect(() => {\n      if (videoRef.current) {\n        const videoElement = videoRef.current\n        const handleTimeUpdate = () => {\n          if (videoElement) {\n            const currentTimeFormatted = formatTime(videoElement.currentTime)\n            setCurrentTime(currentTimeFormatted)\n            const durationFormatted = formatTime(videoElement.duration)\n            setDuration(durationFormatted)\n          }\n        }\n        const handleError = (event: Event) => {\n          const errorEvent = event as any\n          const handlemsg = errorEvent.target.error.message\n          if (handlemsg) {\n            console.error(`Video error:${handlemsg}`)\n            message.warning(handlemsg)\n            setIsPlaying(false)\n          }\n        }\n        videoElement.addEventListener('timeupdate', handleTimeUpdate)\n        videoElement.addEventListener('error', handleError)\n        return () => {\n          videoElement.removeEventListener('timeupdate', handleTimeUpdate)\n          videoElement.removeEventListener('error', handleError)\n        }\n      }\n    }, [])\n\n    const handlePlayPause = () => {\n      if (videoRef.current) {\n        if (isPlaying)\n          videoRef.current.pause()\n        else videoRef.current.play()\n\n        setIsPlaying(!isPlaying)\n      }\n    }\n\n    const handleReload = () => {\n      if (videoRef.current) {\n        videoRef.current.load()\n        setIsPlaying(false)\n        setProgress(0)\n        setCurrentTime('00:00')\n        setDuration('00:00')\n      }\n    }\n\n    const handleFastForward = () => {\n      if (videoRef.current) {\n        videoRef.current.currentTime += 3\n        setProgress(\n          (videoRef.current.currentTime / videoRef.current.duration) * 100,\n        )\n      }\n    }\n\n    const handleRewind = () => {\n      if (videoRef.current) {\n        videoRef.current.currentTime -= 3\n        setProgress(\n          (videoRef.current.currentTime / videoRef.current.duration) * 100,\n        )\n      }\n    }\n\n    const handleVolumeUp = () => {\n      if (videoRef.current) {\n        const newVolume = Math.min(volume + 0.1, 1)\n        setVolume(newVolume)\n        videoRef.current.volume = newVolume\n      }\n    }\n\n    const handleVolumeDown = () => {\n      if (videoRef.current) {\n        const newVolume = Math.max(volume - 0.1, 0)\n        setVolume(newVolume)\n        videoRef.current.volume = newVolume\n      }\n    }\n\n    const handleFullScreen = () => {\n      videoRef.current?.requestFullscreen()\n    }\n\n    const handleProgress = () => {\n      if (!isDragging && videoRef.current) {\n        const currentTime = videoRef.current.currentTime\n        const duration = videoRef.current.duration\n        const progressPercentage = (currentTime / duration) * 100\n        setProgress(progressPercentage)\n      }\n    }\n\n    const handleDragStart = () => {\n      setIsDragging(true)\n    }\n\n    const handleDragEnd = (\n      event:\n        | React.MouseEvent<HTMLProgressElement>\n        | React.TouchEvent<HTMLProgressElement>,\n    ) => {\n      if (videoRef.current) {\n        const progressBar = event.currentTarget as HTMLProgressElement\n        const clickPosition\n          = event.type === 'touchend'\n            ? (event as React.TouchEvent<HTMLProgressElement>).changedTouches[0]\n                .clientX - progressBar.getBoundingClientRect().left\n            : (event as React.MouseEvent<HTMLProgressElement>).clientX\n            - progressBar.getBoundingClientRect().left\n        const progressPercentage\n          = (clickPosition / progressBar.offsetWidth) * 100\n        setProgress(progressPercentage)\n        videoRef.current.currentTime\n          = (progressPercentage / 100) * videoRef.current.duration\n      }\n      setIsDragging(false)\n    }\n\n    const handleTogglePictureInPicture = () => {\n      if (videoRef.current) {\n        if (document.pictureInPictureElement) {\n          document\n            .exitPictureInPicture()\n            .then(() => setIsPictureInPicture(false))\n            .catch(error =>\n              console.error('Error exiting Picture-in-Picture mode:', error),\n            )\n        }\n        else {\n          videoRef.current\n            .requestPictureInPicture()\n            .then(() => setIsPictureInPicture(true))\n            .catch(error =>\n              console.error('Error entering Picture-in-Picture mode:', error),\n            )\n        }\n      }\n    }\n\n    return (\n      <div className=\"relative\">\n        <video\n          ref={(videoElement) => {\n            if (videoElement) {\n              (videoRef as MutableRefObject<HTMLVideoElement>).current\n                = videoElement\n              if (ref) {\n                if (typeof ref === 'function') {\n                  ref(videoElement)\n                }\n                else {\n                  (ref as MutableRefObject<HTMLVideoElement>).current\n                    = videoElement\n                }\n              }\n            }\n          }}\n          style={{ width, height }}\n          src={src}\n          className=\"w-full h-auto\"\n          onTimeUpdate={handleProgress}\n          onEnded={() => setIsPlaying(false)}\n        />\n        <div className=\"absolute bottom-15 z-998 left-0 right-0 flex justify-center space-x-4\">\n          <button className=\"cursor-pointer text-ccc\" onClick={handlePlayPause}>\n            {isPlaying ? t('VSZdxVOM') : t('GTuxgysd')}\n          </button>\n          <button className=\"cursor-pointer text-ccc\" onClick={handleReload}>\n            {t('kYVkmXtK')}\n            {' '}\n            3\n          </button>\n          <button\n            className=\"cursor-pointer text-ccc\"\n            onClick={handleFastForward}\n          >\n            {t('fZYVSWPZ')}\n            {' '}\n            3\n            {t('lNCFQVIz')}\n          </button>\n          <button className=\"cursor-pointer text-ccc\" onClick={handleRewind}>\n            {t('KQExjfzI')}\n            {' '}\n            3\n            {t('lNCFQVIz')}\n          </button>\n          <button className=\"cursor-pointer text-ccc\" onClick={handleVolumeUp}>\n            {t('tPLJAbEn')}\n          </button>\n          <button\n            className=\"cursor-pointer text-ccc\"\n            onClick={handleVolumeDown}\n          >\n            {t('UzSeBVPp')}\n          </button>\n          <button\n            className=\"cursor-pointer text-ccc\"\n            onClick={handleFullScreen}\n          >\n            {t('pltSfqMA')}\n          </button>\n          <button\n            className=\"cursor-pointer text-ccc\"\n            onClick={handleTogglePictureInPicture}\n          >\n            {isPictureInPicture ? t('nKQaojFg') : t('LLefTaMy')}\n          </button>\n        </div>\n        <div className=\"absolute bottom-5 left-0 right-0 mb-4 px-4  z-999\">\n          <progress\n            value={progress}\n            max={100}\n            onMouseDown={handleDragStart}\n            onMouseUp={handleDragEnd}\n            onTouchStart={handleDragStart}\n            onTouchEnd={handleDragEnd}\n            className=\"w-full h-2 bg-gray-300 rounded-full overflow-hidden cursor-pointer\"\n          >\n          </progress>\n        </div>\n        <div className=\"absolute bottom-0 left-0 right-0 mb-2 px-4 flex justify-between text-white\">\n          <span>{currentTime}</span>\n          <span>{duration}</span>\n        </div>\n      </div>\n    )\n  },\n)\n\nexport default VideoPlayer\n","import debounce from 'lodash/debounce'\nimport throttle from 'lodash/throttle'\nimport type { ChangeEvent, FormEvent } from 'react'\nimport React, { useRef, useState } from 'react'\nimport { Button, Form, Input, message } from 'antd'\nimport { t } from '@/utils'\nimport VideoPlayer from '@/components/video-player'\n\nconst VideoPage: React.FC = () => {\n  const [videoSrc, setVideoSrc] = useState<string>(\n    'https://www.w3schools.com/html/mov_bbb.mp4',\n  )\n  const [isValidUrl, setIsValidUrl] = useState<boolean>(true)\n  const videoRef = useRef<HTMLVideoElement>(null)\n\n  const handleUrlChangeDebounced = debounce((url: string) => {\n    // Use regular expression to validate URL format\n    const urlRegex = /^(https?|ftp):\\/\\/[^\\s/$.?#].[^\\s]*$/i\n    if (urlRegex.test(url)) {\n      setIsValidUrl(true)\n      setVideoSrc(url)\n    }\n    else {\n      setIsValidUrl(false)\n      message.error(t('qTvFdqOH'))\n    }\n  }, 500) // 500ms debounce delay\n\n  const handleUrlChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const url = e.target.value\n    handleUrlChangeDebounced(url)\n  }\n\n  const handlePlayThrottled = throttle(() => {\n    if (videoRef.current)\n      videoRef.current.play()\n    else message.error(`${`${t('eKfCNkqq')}videoPlayer${t('bikocJSR')}`}`)\n  }, 1000) // 1000ms throttle interval\n\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\n    console.log(\n      '%c [ e ]-39',\n      'font-size:13px; background:pink; color:#bf2c9f;',\n      e,\n    )\n    handlePlayThrottled()\n  }\n\n  return (\n    <div>\n      <Form onFinish={handleSubmit}>\n        <Form.Item name=\"videoSrc\" initialValue={videoSrc}>\n          <Input\n            placeholder={`${`${t('NvDIWzLK')}mp4${t('EOtrIDGy')}`}`}\n            onChange={handleUrlChange}\n            value={videoSrc}\n            suffix={(\n              <Button type=\"primary\" htmlType=\"submit\">\n                {t('OWuSVBcv')}\n              </Button>\n            )}\n          />\n        </Form.Item>\n      </Form>\n      {!isValidUrl && <p style={{ color: 'red' }}>{`${t('qTvFdqOH')}`}</p>}\n      <VideoPlayer ref={videoRef} src={videoSrc} />\n    </div>\n  )\n}\n\nexport default VideoPage\n"],"names":["VideoPlayer","forwardRef","props","ref","src","width","height","videoRef","useRef","isPlaying","setIsPlaying","useState","volume","setVolume","progress","setProgress","isDragging","setIsDragging","currentTime","setCurrentTime","duration","setDuration","isPictureInPicture","setIsPictureInPicture","formatTime","time","minutesStr","String","Math","floor","padStart","secondsStr","useEffect","current","videoElement","handleTimeUpdate","handleError","event","handlemsg","errorEvent","target","error","message","console","addEventListener","removeEventListener","handleDragStart","handleDragEnd","progressBar","currentTarget","progressPercentage","clickPosition","type","changedTouches","clientX","getBoundingClientRect","left","offsetWidth","className","style","onTimeUpdate","onEnded","onClick","pause","play","t","load","newVolume","min","max","requestFullscreen","document","pictureInPictureElement","exitPictureInPicture","then","catch","requestPictureInPicture","value","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","videoSrc","setVideoSrc","isValidUrl","setIsValidUrl","handleUrlChangeDebounced","url","urlRegex","test","handlePlayThrottled","Form","onFinish","e","log","name","initialValue","Input","placeholder","onChange","suffix","Button","htmlType","color"],"mappings":"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"}